<!doctype html>
<script src="lib/underscore.js"></script>
<script src="lib/d3.v2.js"></script>
<script>
var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
d3.csv("../data/lettuce.csv", function(raw) {
  var years = _.pluck(raw, "Year");
  var min_year = d3.min(years),
      max_year = d3.max(years),
      min_month = _(months).find(function(m) { return raw[0][m] != undefined; }),
      max_month = _(months).find(function(m,i) { return raw[raw.length-1][months[i+1]] == " "; });  // following month has no value

  var data = _(years).chain()
    .map(function(year,i) {
      return _(months).map(function(month,j) {
        return {
          date: (new Date(year, months.indexOf(month))).getTime(),
          value: raw[i][month]
        }
      });
    })
    .flatten()
    .value()
});
</script>
